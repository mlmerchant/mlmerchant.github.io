<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Submarine Game</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      text-align: center;
    }
    .full-width-button {
      width: 100%;
      padding: 20px;
      font-size: 1.5rem;
      border: none;
      cursor: pointer;
    }
    .button-container {
      position: absolute;
      width: 100%;
      height: 100%;
      background-color: white;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 10px;
    }
    #gameContainer {
      display: none;
      position: relative;
      width: 800px;
      height: 600px;
      background: linear-gradient(to bottom, #1E90FF 10%, #00008B 10%);
      border: 2px solid black;
      overflow: hidden;
      margin: 20px auto;
    }
    .touch-controls {
      display: none;
      width: 800px;
      margin: 10px auto;
      text-align: center;
    }
    .touch-controls button {
      width: 160px;
      height: 160px;
      font-size: 1.2rem;
      margin: 0 40px;
    }
  </style>
</head>
<body>

  <div class="button-container" id="startMenu">
    <button class="full-width-button" id="keyboardButton">Play with Arrow Keys and Space bar</button>
    <button class="full-width-button" id="touchButton">Play with Touch Controls</button>
  </div>

  <div id="gameContainer"></div>

  <div class="touch-controls" id="touchControls">
    <button id="leftBtn">Left</button>
    <button id="shootBtn">Shoot</button>
    <button id="rightBtn">Right</button>
  </div>

  <script>
    document.getElementById("keyboardButton").addEventListener("click", function() {
      startGame(false);
    });

    document.getElementById("touchButton").addEventListener("click", function() {
      startGame(true);
    });

    function startGame(useTouchControls) {
      document.getElementById("startMenu").style.display = "none";
      document.getElementById("gameContainer").style.display = "block";
      
      if (useTouchControls) {
        document.getElementById("touchControls").style.display = "block";
      }

      initializeGame(useTouchControls);
    }

    function initializeGame(useTouchControls) {
      const gameContainer = document.getElementById("gameContainer");

      const ship = document.createElement("div");
      ship.style.position = "absolute";
      ship.style.top = "30px";
      ship.style.left = "50%";
      ship.style.width = "80px";
      ship.style.height = "30px";
      ship.style.backgroundColor = "gray";
      ship.style.clipPath = "polygon(0% 100%, 10% 70%, 30% 60%, 70% 60%, 90% 70%, 100% 100%, 100% 100%, 0% 100%)";
      ship.style.transform = "translateX(-50%)";
      gameContainer.appendChild(ship);

      let leftArrowDown = false;
      let rightArrowDown = false;
      let shipVelocity = 0;
      const acceleration = 0.3;
      const maxSpeed = 6;
      const shipMinX = 80;
      const shipMaxX = 720;

      function updateShip() {
        if (leftArrowDown && !rightArrowDown) {
          shipVelocity -= acceleration;
        } else if (rightArrowDown && !leftArrowDown) {
          shipVelocity += acceleration;
        }

        if (shipVelocity > maxSpeed) shipVelocity = maxSpeed;
        if (shipVelocity < -maxSpeed) shipVelocity = -maxSpeed;

        let currentLeft = parseInt(ship.style.left);
        currentLeft += shipVelocity;

        if (currentLeft < shipMinX) {
          currentLeft = shipMinX;
          shipVelocity = 0;
        } else if (currentLeft > shipMaxX) {
          currentLeft = shipMaxX;
          shipVelocity = 0;
        }
        ship.style.left = currentLeft + "px";
      }

      const shipMovementInterval = setInterval(updateShip, 20);

      if (!useTouchControls) {
        document.addEventListener("keydown", (e) => {
          if (e.key === "ArrowLeft") leftArrowDown = true;
          else if (e.key === "ArrowRight") rightArrowDown = true;
          else if (e.key === " ") createDepthCharge(parseInt(ship.style.left) + 30);
        });

        document.addEventListener("keyup", (e) => {
          if (e.key === "ArrowLeft") leftArrowDown = false;
          else if (e.key === "ArrowRight") rightArrowDown = false;
        });
      } else {
        document.getElementById("leftBtn").addEventListener("touchstart", () => leftArrowDown = true);
        document.getElementById("leftBtn").addEventListener("touchend", () => leftArrowDown = false);
        document.getElementById("rightBtn").addEventListener("touchstart", () => rightArrowDown = true);
        document.getElementById("rightBtn").addEventListener("touchend", () => rightArrowDown = false);
        document.getElementById("shootBtn").addEventListener("touchstart", () => createDepthCharge(parseInt(ship.style.left) + 30));
      }

      function createDepthCharge(x) {
        const charge = document.createElement("div");
        charge.style.position = "absolute";
        charge.style.width = "10px";
        charge.style.height = "10px";
        charge.style.backgroundColor = "gray";
        charge.style.left = `${x}px`;
        charge.style.top = "50px";
        gameContainer.appendChild(charge);

        const moveCharge = setInterval(() => {
          const chargeTop = parseInt(charge.style.top);
          if (chargeTop >= 600) {
            clearInterval(moveCharge);
            charge.remove();
            return;
          }
          charge.style.top = `${chargeTop + 5}px`;
        }, 20);
      }
    }
  </script>

</body>
</html>
